<style>
    .custom-border-right{
        border: 1px solid #d2cfcf;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        height: auto;
        overflow-y: auto;
    }
    .custom-border {
        border: 1px solid #d2cfcf;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        height: auto;
        overflow-y: auto;
    }
    .custom-button {
        width: 100%;
    }
    .custom-message {
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        padding: 10px;
        margin-top: 20px;
        border-radius: 5px;
    }
    .reiniciar-button.disabled {
        background-color: #cccccc;
        color: #666666;
    }
    .fixed-title {
        position: sticky;
        top: 0;
        color: white;
        padding: 10px;
        margin-bottom: 10px;
    }
    .file-list-container {
        max-height: 400px;
        overflow-y: auto;
    }
    .xml-list {
        list-style: none;
        padding-left: 0;
    }
    .xml-list li {
        padding: 8px;
        border-bottom: 1px solid #ccc;
    }
    .bg-light {
        background-color: #f8f9fa;
    }
    .custom-button {
        background-color: rgba(10, 10, 248, 0.73);
        color: white;
        border: none;
        border-radius: 5px;
        padding: 10px 20px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

</style>

<div class="container mt-5">
  <h2 class="text-Left mb-3">Conversor de XMLS</h2>

  <div class="row">

    <!-- Div para o formul√°rio e mensagens -->
    <div class="col-md-6 custom-border"> <!-- Ajustado para ocupar 6 colunas -->
      <form id="processar-form" action="/items/processar" method="post">
        <button id="processar-button" type="submit" class="btn btn-primary btn-block custom-button" disabled>Processar</button>
      </form>
      <% if @xml_count && @xml_count > 0 %>
        <div class="alert alert-info mt-3" role="alert">
          Existem <%= @xml_count %> XMLs dispon√≠veis.
        </div>
      <% end %>

      <% if flash[:notice] %>
        <div class="alert alert-success mt-3" role="alert">
          <%= flash[:notice] %>
        </div>
      <% end %>

      <% if flash[:alert] %>
        <div class="alert alert-danger mt-3" role="alert">
          <%= flash[:alert] %>
        </div>
      <% end %>

      <div class="custom-message mt-3">
        O diret√≥rio padr√£o √©: /home/angelosouza/Projetos /Leitor-Xml/xmls <br>
        O diret√≥rio json √©: /home/angelosouza/Projetos /Leitor-Xml/json
      </div>

      <!-- Bot√£o para reiniciar a aplica√ß√£o -->
      <button onclick="reiniciarAplicacao()" id="reiniciar-button"  class="btn btn-primary mt-3 reiniciar-button disabled">Reiniciar</button>
    </div>

    <!-- Div para exibir os dados atuais -->
    <div class="col-md-6 custom-border-right"> <!-- Ajustado para ocupar 6 colunas -->
      <h5 class="fixed-title custom-button">Nomes dos Arquivos  :    <span style="color: yellow;"><%= @xml_files.count %></span></h5>
      <div class="file-list-container">
        <% if @xml_files.any? %>
          <ul class="xml-list">
            <% @xml_files.each_with_index do |xml_file, index| %>
              <% if index.even? %>
                <li class="bg-light">
                  <span>‚úÖ</span>
                  <span>üìÑ</span>
                  <%= xml_file %>
                </li>
              <% else %>
                <li class="bg-info">
                  <span>‚úÖ</span>
                  <span>üìÑ</span>
                  <%= xml_file %>
                </li>
              <% end %>
            <% end %>
          </ul>
        <% else %>
          <p>Nenhum arquivo XML dispon√≠vel.</p>
        <% end %>
      </div>
    </div>

    <!-- Div para a nova se√ß√£o -->
    <div class="col-md-6 custom-border"> <!-- Ajustado para ocupar 6 colunas -->
      <h3>Nova Se√ß√£o</h3>
      <p>Aqui voc√™ pode adicionar qualquer conte√∫do para a nova se√ß√£o.</p>
    </div>

    <!-- Adicionando a funcionalidade JavaScript -->
    <script>
        // Fun√ß√£o para ocultar as mensagens
        function ocultarMensagens() {
            document.querySelectorAll('.alert').forEach(function(alert) {
                alert.style.display = 'none';
            });
        }


        // Fun√ß√£o para desabilitar o bot√£o "Reiniciar"
        function disableReiniciarButton() {
            document.getElementById("reiniciar-button").classList.add('disabled');
            document.getElementById("reiniciar-button").disabled = true;
        }

        // Fun√ß√£o para habilitar o bot√£o "Reiniciar"
        function habilitarReiniciarButton() {
            document.getElementById("reiniciar-button").classList.remove('disabled');
            document.getElementById("reiniciar-button").disabled = false;
            habilitarGerarJSONButton(); // Chama a fun√ß√£o para habilitar o bot√£o "Gerar JSON"
        }

        // Fun√ß√£o para habilitar o bot√£o "Processar XMLs" ao iniciar
        function habilitarProcessarButton() {
            document.getElementById("processar-button").disabled = false;
        }

        function reiniciarAplicacao() {
            disableReiniciarButton()
            ocultarMensagens()
            // Habilita o bot√£o "Processar XMLs"
            habilitarProcessarButton();
            habilitarGerarJSONButton(); // Habilita o bot√£o "Gerar JSON" se houver arquivos na lista
            // Recarrega a p√°gina para reiniciar a aplica√ß√£o
            window.location.reload();
        }

        // Adiciona um evento de envio ao formul√°rio para habilitar o bot√£o "Reiniciar" ap√≥s o envio
        document.getElementById("processar-form").addEventListener("submit", function() {
            habilitarReiniciarButton();
            habilitarGerarJSONButton(); // Habilita o bot√£o "Gerar JSON" se houver arquivos na lista
        });

        // Verifica se existem mensagens flash, se sim, habilita o bot√£o "Reiniciar"
        <% if flash[:notice] || flash[:alert] %>
        habilitarReiniciarButton();
        <% end %>

        // Chama a fun√ß√£o para habilitar o bot√£o "Processar XMLs" ao iniciar a p√°gina
        habilitarProcessarButton();
    </script>
  </div>
