<style>
    .custom-border {
        border: 1px solid #d2cfcf; /* Definindo a largura da borda */
        border-radius: 8px; /* Arredondando os cantos da borda */
        padding: 20px; /* Adicionando espa√ßo interno */
        margin-bottom: 20px; /* Adicionando margem na parte inferior */
        height: 460px; /* Definindo a altura da div */
        overflow-y: auto; /* Adicionando scroll vertical caso o conte√∫do ultrapasse a altura */
    }
    .custom-border-right {
        border: 1px solid #d2cfcf; /* Definindo a largura da borda */
        border-radius: 8px; /* Arredondando os cantos da borda */
        padding: 20px; /* Adicionando espa√ßo interno */
        margin-bottom: 20px; /* Adicionando margem na parte inferior */
        height: 460px; /* Definindo a altura da div */
        overflow-y: auto; /* Adicionando scroll vertical caso o conte√∫do ultrapasse a altura */
        position: relative; /* Permite o posicionamento relativo */
        left: 20px; /* Definindo o deslocamento para a esquerda */
    }
    .custom-button {
        width: 100%; /* Definindo a largura do bot√£o como 100% */
    }
    .custom-message {
        background-color: #f0f0f0; /* Definindo a cor de fundo */
        border: 1px solid #ccc; /* Adicionando borda */
        padding: 10px; /* Adicionando espa√ßo interno */
        margin-top: 20px; /* Adicionando margem superior */
        border-radius: 5px; /* Arredondando os cantos */
    }
    .reiniciar-button.disabled {
        background-color: #cccccc; /* Cor de fundo cinza */
        color: #666666; /* Cor do texto cinza mais escuro */
    }
    .fixed-title {
        position: sticky; /* Define o t√≠tulo como fixo */
        top: 0; /* Fixa o t√≠tulo no topo da div */
        color: white; /* Define a cor do texto como branco para melhor legibilidade */
        padding: 10px; /* Adiciona espa√ßo interno ao t√≠tulo */
        margin-bottom: 10px; /* Adiciona margem inferior para separar do restante dos itens */
    }

    .file-list-container {
        max-height: 400px; /* Define a altura m√°xima da lista */
        overflow-y: auto; /* Adiciona scroll vertical caso a lista seja maior que a altura m√°xima */
    }

    .xml-list {
        list-style: none; /* Remove os estilos padr√£o da lista */
        padding-left: 0; /* Remove o recuo padr√£o √† esquerda da lista */
    }

    .xml-list li {
        padding: 8px; /* Adiciona espa√ßo interno aos itens da lista */
        border-bottom: 1px solid #ccc; /* Adiciona uma linha divis√≥ria entre os itens */
    }

    .bg-light {
        background-color: #f8f9fa; /* Define a cor de fundo para itens √≠mpares */
    }
    .custom-button {
        background-color: rgba(10, 10, 248, 0.73); /* Cor de fundo azul */
        color: white; /* Cor do texto branco */
        border: none; /* Remove a borda */
        border-radius: 5px; /* Arredonda os cantos */
        padding: 10px 20px; /* Adiciona espa√ßo interno */
        cursor: pointer; /* Altera o cursor ao passar o mouse */
        transition: background-color 0.3s ease; /* Transi√ß√£o suave da cor de fundo */
    }
    .download-link {
        display: block; /* Faz o link ocupar toda a largura do seu cont√™iner */
        margin-top: 10px; /* Adiciona espa√ßo superior para separa√ß√£o */
    }
</style>

<div class="container mt-5">
  <h2 class="text-Left mb-3">Conversor de XMLS</h2>

  <div class="row">

    <!-- Div para o formul√°rio e mensagens -->
    <div class="col-md-6 custom-border">
      <form id="processar-form" action="/items/processar" method="post">
        <button id="processar-button" type="submit" class="btn btn-primary btn-block custom-button" disabled>Processar</button>
      </form>
      <% if @xml_count && @xml_count > 0 %>
        <div class="alert alert-info mt-3" role="alert">
          Existem <%= @xml_count %> XMLs dispon√≠veis.
        </div>
      <% end %>

      <% if flash[:notice] %>
        <div class="alert alert-success mt-3" role="alert">
          <%= flash[:notice] %>
        </div>
      <% end %>

      <% if flash[:alert] %>
        <div class="alert alert-danger mt-3" role="alert">
          <%= flash[:alert] %>
        </div>
      <% end %>

      <div class="custom-message mt-3">
        O diret√≥rio padr√£o √©: /home/angelosouza/Projetos /Leitor-Xml/xmls
        O diret√≥rio json √©: /home/angelosouza/Projetos /Leitor-Xml/json
      </div>



      <!-- Bot√£o para reiniciar a aplica√ß√£o -->
      <button onclick="reiniciarAplicacao()" id="reiniciar-button"  class="btn btn-primary mt-3 reiniciar-button disabled">Reiniciar</button>




    </div>

    <!-- Div para exibir os dados atuais -->
    <div class="col-md-6 custom-border-right">
      <h5 class="fixed-title custom-button">Nomes dos Arquivos  :    <span style="color: yellow;"><%= @xml_files.count %></h5>
      <div class="file-list-container">
        <% if @xml_files.any? %>
          <ul class="xml-list"> <!-- Adicionando a classe "xml-list" √† lista -->
            <% @xml_files.each_with_index do |xml_file, index| %>
              <% if index.even? %> <!-- Alternando cores de fundo -->
                <li class="bg-light">
                  <span>‚úÖ</span> <!-- Emoji de checklist -->
                  <span>üìÑ</span> <!-- Emoji representando a extens√£o XML -->
                  <%= xml_file %>
                </li>
              <% else %>
                <li class="bg-info">
                  <span>‚úÖ</span> <!-- Emoji de checklist -->
                  <span>üìÑ</span> <!-- Emoji representando a extens√£o XML -->
                  <%= xml_file %>
                </li>
              <% end %>
            <% end %>
          </ul>
        <% else %>
          <p>Nenhum arquivo XML dispon√≠vel.</p>
        <% end %>
      </div>
    </div>


    <!-- Adicionando a funcionalidade JavaScript -->
    <script>
        // Fun√ß√£o para ocultar as mensagens
        function ocultarMensagens() {
            document.querySelectorAll('.alert').forEach(function(alert) {
                alert.style.display = 'none';
            });
        }


        // Fun√ß√£o para desabilitar o bot√£o "Reiniciar"
        function disableReiniciarButton() {
            document.getElementById("reiniciar-button").classList.add('disabled');
            document.getElementById("reiniciar-button").disabled = true;
        }

        // Fun√ß√£o para habilitar o bot√£o "Reiniciar"
        function habilitarReiniciarButton() {
            document.getElementById("reiniciar-button").classList.remove('disabled');
            document.getElementById("reiniciar-button").disabled = false;
            habilitarGerarJSONButton(); // Chama a fun√ß√£o para habilitar o bot√£o "Gerar JSON"
        }

        // Fun√ß√£o para habilitar o bot√£o "Processar XMLs" ao iniciar
        function habilitarProcessarButton() {
            document.getElementById("processar-button").disabled = false;
        }

        function reiniciarAplicacao() {
            disableReiniciarButton()
            ocultarMensagens()
            // Habilita o bot√£o "Processar XMLs"
            habilitarProcessarButton();
            habilitarGerarJSONButton(); // Habilita o bot√£o "Gerar JSON" se houver arquivos na lista
            // Recarrega a p√°gina para reiniciar a aplica√ß√£o
            window.location.reload();
        }

        // Adiciona um evento de envio ao formul√°rio para habilitar o bot√£o "Reiniciar" ap√≥s o envio
        document.getElementById("processar-form").addEventListener("submit", function() {
            habilitarReiniciarButton();
            habilitarGerarJSONButton(); // Habilita o bot√£o "Gerar JSON" se houver arquivos na lista
        });

        // Verifica se existem mensagens flash, se sim, habilita o bot√£o "Reiniciar"
        <% if flash[:notice] || flash[:alert] %>
        habilitarReiniciarButton();
        <% end %>



        // Chama a fun√ß√£o para habilitar o bot√£o "Processar XMLs" ao iniciar a p√°gina
        habilitarProcessarButton();
    </script>