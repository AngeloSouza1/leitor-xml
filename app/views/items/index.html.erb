<!-- View items/index.html.erb -->

<style>
    .custom-border {
        border: 1px solid #d2cfcf; /* Definindo a largura da borda */
        border-radius: 8px; /* Arredondando os cantos da borda */
        padding: 20px; /* Adicionando espaço interno */
        margin-bottom: 20px; /* Adicionando margem na parte inferior */
        height: 460px; /* Definindo a altura da div */
        overflow-y: auto; /* Adicionando scroll vertical caso o conteúdo ultrapasse a altura */
    }
    .custom-border-right {
        border: 1px solid #d2cfcf; /* Definindo a largura da borda */
        border-radius: 8px; /* Arredondando os cantos da borda */
        padding: 20px; /* Adicionando espaço interno */
        margin-bottom: 20px; /* Adicionando margem na parte inferior */
        height: 460px; /* Definindo a altura da div */
        overflow-y: auto; /* Adicionando scroll vertical caso o conteúdo ultrapasse a altura */
        position: relative; /* Permite o posicionamento relativo */
        left: 20px; /* Definindo o deslocamento para a esquerda */
    }
    .custom-button {
        width: 100%; /* Definindo a largura do botão como 100% */
    }
    .custom-message {
        background-color: #f0f0f0; /* Definindo a cor de fundo */
        border: 1px solid #ccc; /* Adicionando borda */
        padding: 10px; /* Adicionando espaço interno */
        margin-top: 20px; /* Adicionando margem superior */
        border-radius: 5px; /* Arredondando os cantos */
    }
    .reiniciar-button.disabled {
        background-color: #cccccc; /* Cor de fundo cinza */
        color: #666666; /* Cor do texto cinza mais escuro */
    }
    .fixed-title {
        position: sticky; /* Define o título como fixo */
        top: 0; /* Fixa o título no topo da div */
        color: white; /* Define a cor do texto como branco para melhor legibilidade */
        padding: 10px; /* Adiciona espaço interno ao título */
        margin-bottom: 10px; /* Adiciona margem inferior para separar do restante dos itens */
    }

    .file-list-container {
        max-height: 400px; /* Define a altura máxima da lista */
        overflow-y: auto; /* Adiciona scroll vertical caso a lista seja maior que a altura máxima */
    }

    .xml-list {
        list-style: none; /* Remove os estilos padrão da lista */
        padding-left: 0; /* Remove o recuo padrão à esquerda da lista */
    }

    .xml-list li {
        padding: 8px; /* Adiciona espaço interno aos itens da lista */
        border-bottom: 1px solid #ccc; /* Adiciona uma linha divisória entre os itens */
    }

    .bg-light {
        background-color: #f8f9fa; /* Define a cor de fundo para itens ímpares */
    }
    .custom-button {
        background-color: rgba(10, 10, 248, 0.73); /* Cor de fundo azul */
        color: white; /* Cor do texto branco */
        border: none; /* Remove a borda */
        border-radius: 5px; /* Arredonda os cantos */
        padding: 10px 20px; /* Adiciona espaço interno */
        cursor: pointer; /* Altera o cursor ao passar o mouse */
        transition: background-color 0.3s ease; /* Transição suave da cor de fundo */
    }
</style>

<div class="container mt-5">
  <h2 class="text-Left mb-3">Conversor de XMLS</h2>

  <div class="row">

    <!-- Div para o formulário e mensagens -->
    <div class="col-md-6 custom-border">
      <form id="processar-form" action="/items/processar" method="post">
        <button id="processar-button" type="submit" class="btn btn-primary btn-block custom-button" disabled>Processar XMLs</button>
      </form>
      <% if @xml_count && @xml_count > 0 %>
        <div class="alert alert-info mt-3" role="alert">
          Existem <%= @xml_count %> XMLs disponíveis.
        </div>
      <% end %>

      <% if flash[:notice] %>
        <div class="alert alert-success mt-3" role="alert">
          <%= flash[:notice] %>
        </div>
      <% end %>

      <% if flash[:alert] %>
        <div class="alert alert-danger mt-3" role="alert">
          <%= flash[:alert] %>
        </div>
      <% end %>

      <div class="custom-message mt-3">
        <p>O diretório padrão é: /home/angelosouza/Projetos /Leitor-Xml/xmls</p>
      </div>

      <!-- Botão para reiniciar a aplicação -->
      <button onclick="reiniciarAplicacao()" id="reiniciar-button" class="btn btn-primary mt-3 reiniciar-button disabled">Reiniciar</button>

    </div>

    <!-- Div para exibir os dados atuais -->
    <div class="col-md-6 custom-border-right">
<!--      <h4 class="fixed-title">Nomes dos Arquivos</h4> <!-- Título fixo -->
      <h4 class="fixed-title custom-button">Nomes dos Arquivos</h4> <!-- Título com a mesma cor de fundo do botão -->

      <div class="file-list-container">
        <% if @xml_files.any? %>
          <ul class="xml-list"> <!-- Adicionando a classe "xml-list" à lista -->
            <% @xml_files.each_with_index do |xml_file, index| %>
              <% if index.even? %> <!-- Alternando cores de fundo -->
                <li class="bg-light"><i class="fas fa-file-alt"></i> <%= xml_file %></li>
              <% else %>
                <li class="bg-white"><i class="fas fa-file-alt"></i> <%= xml_file %></li>
              <% end %>
            <% end %>
          </ul>
        <% else %>
          <p>Nenhum arquivo XML disponível.</p>
        <% end %>
      </div>
    </div>



    <!-- Adicionando a funcionalidade JavaScript -->
    <script>
        // Função para desabilitar o botão "Reiniciar"
        function disableReiniciarButton() {
            document.getElementById("reiniciar-button").classList.add('disabled');
            document.getElementById("reiniciar-button").disabled = true;
        }

        // Função para habilitar o botão "Reiniciar"
        function habilitarReiniciarButton() {
            document.getElementById("reiniciar-button").classList.remove('disabled');
            document.getElementById("reiniciar-button").disabled = false;
        }

        // Função para reiniciar a aplicação
        function reiniciarAplicacao() {
            // Habilita o botão "Processar XMLs"
            document.getElementById("processar-button").disabled = false;
            // Recarrega a página para reiniciar a aplicação
            window.location.reload();
        }

        // Adiciona um evento de envio ao formulário para habilitar o botão "Reiniciar" após o envio
        document.getElementById("processar-form").addEventListener("submit", function() {
            habilitarReiniciarButton();
        });

        // Verifica se existem mensagens flash, se sim, habilita o botão "Reiniciar"
        <% if flash[:notice] || flash[:alert] %>
        habilitarReiniciarButton();
        <% end %>
    </script>